<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" 
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <meta name="robots" content="noindex, nofollow">
    <meta name="googlebot" content="noindex, nofollow">
    <title>Guilda - Aden RPG</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="maintenance.js"></script>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="mines.css" />
    <link rel="stylesheet" href="guild.css" />
<script>
   // Registro do Service Worker Otimizado
if ('serviceWorker' in navigator) {
    const registerSW = () => {
        navigator.serviceWorker.register('/sw.js')
            .then(reg => {
                // Verifica se há atualizações a cada 1 hora se o app ficar aberto
                setInterval(() => reg.update(), 60 * 60 * 1000); 
                
                if (reg.installing) {
                    console.log('⚙️ SW: Instalando...');
                } else if (reg.waiting) {
                    console.log('⚙️ SW: Aguardando ativação...');
                } else if (reg.active) {
                    console.log('✅ SW: Ativo e servindo cache!');
                }
            })
            .catch(err => console.error('❌ Erro ao registrar SW:', err));
    };
  </script>
</head>
<body>

    <div id="playerTopBar">
        <button id="menuToggleBtn" class="top-bar-link" style="background:none; border:none; cursor:pointer; color:inherit; padding:0;">
    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="3" y1="12" x2="21" y2="12"></line>
        <line x1="3" y1="6" x2="21" y2="6"></line>
        <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
</button>
       <div> <span id="pageTitle">Guilda</span></div>
        <img src="https://aden-rpg.pages.dev/assets/refresh.webp" alt="Recarregar" style="width:30px; height:30px; opacity: 0;">
    </div>

    <div id="mainContainer">
        <div id="tabMenu">
            <span class="tab-btn active" data-tab="guilda">Guilda</span>
            <span class="tab-btn" data-tab="taverna">Taverna</span>
            <span class="tab-btn" data-tab="ranking">Ranking</span>
            <span class="tab-btn" data-tab="raid">Raid</span>
            <span class="tab-btn" data-tab="batalhas">Batalha</span>
        </div>

        <div id="tabContent">
            <div id="guilda" class="tab-pane active">
                <div id="guildInfoContainer" style="display:none;">
                   
              <div class="icon-container"><img id="editGuildBtn" src="https://aden-rpg.pages.dev/assets/config.webp" style="width:34px;height:34px;border-radius:4px; display: none;"></img></div>     
                    <div id="guildInfoHeader" style="display:flex; justify-content:center; align-items:center;">
                  
                        
                    </div>
                   <div id="guildName"></div>
<img alt="poder" id="cpIcon" style="width: 20px; height: 32px; margin-top: -4px;" src="https://aden-rpg.pages.dev/assets/CPicon.webp"/> <span id="guildPower" style="font-weight:bold; font-size:1.8em; margin-top:4px;"></span>

                    <div id="guildDescription" style="margin:6px 0;color:white; font-size: 0.8em;"></div>
                    
                    <div id="guildLevel">
                        <span style="color: yellow; font-weight: bold; font-size: 0.9em;">Nv. <span id="guildLevelValue"></span></span>
              <div class="xp-bar-container">
    <div class="xp-bar-fill"></div>
    <div id="guildXpFill"></div>
</div>

                    </div>
                    <div class="member-list-container">
                        <h4>Membros (<span id="guildMemberCountHeader">0</span>)</h4>
                        <ul id="guildMemberList"></ul>
                    </div>
                    <br><br><br>
                    <div style="border-bottom: 5px solid grey; border-radius: 8px;"></div>
                    <div id="risco">
  <h3>Área de Risco</h3>
  <div>
    <div id="deleteguild">
     
      <span>Deletar <br>Guilda</span>
    </div>
    <div id="leaveguild">
     
      <span>Sair <br>da Guilda</span>
    </div>
  </div>
</div>
                   
                </div>
                <div id="noGuildContainer" style="display:none;">
                  <div id="criar">
                    <p>Você não faz parte de uma guilda.</p>
                    <button class="action-btn" id="searchGuildBtn" style="color: white;"><span style="font-size: 1em;">Buscar <br>Guilda</span></button>
                    <button class="action-btn" id="createGuildBtn"style="color: white;"><span style="font-size: 1em;">Criar <br>Guilda</span></button>
                </div>
            </div>
</div>
            <div id="taverna" class="tab-pane">
               <div id="tavernContainer" class="tavern-container">
                  <h3 id="tavernTitle" style="margin-top: 110px; display:none;">Taverna da Guilda</h3>
                  <div class="tavern-header-inline" style="margin-top: 80px;display: flex;justify-content: center; align-items: center;">
  <h3 id="tavernTitle2">Taverna da Guilda</h3>
  <img id="tavtuto" src="https://aden-rpg.pages.dev/assets/tutorialbtn.webp" style="width:30px; height:30px; margin-top: -15px; right: 3px;">
  </div>
  <div id="tavernControls" style="margin-bottom:8px;"></div>

  <!-- Área ativa da Taverna (escondida até entrar) -->
  <div id="tavernActiveArea" style="display:none;">

    <div id="tavernChat" class="tavern-chat"></div>
    <div id="tavernChatInput">
      <input type="text" id="tavernMessageInput" placeholder="Digite uma mensagem..." maxlength="200" />
      <button id="tavernSendBtn" style="margin-top: -6px;" disabled>Enviar</button>
    </div>
  </div>
</div>
</div>
            


    

            <div id="ranking" class="tab-pane">
              <center>  <h3>Ranking das Guildas</h3>
              <h4 style="margin-top: -29px; color: orange;">Poder de Combate</h4>
              <p style="margin-top: -30px; font-size: 0.7em;">(atualiza Domingo às 21h)</p>
              </center>
                <ul id="guildRankingList"></ul>
            </div>

            <div id="raid" class="tab-pane" style="background: none;">
              <center><h3>Raid de Guilda</h3></center>
              <div id="raid_1">
               
                <div id="tdd">
                  <h3 class="tdd_h3">Torre da Desolação</h3>
                  <span class="tdd_desc">Segunda, Quarta e<br> Sexta-feira até 21h.<br>Líder e Co-Líderes<br>podem iniciar a Raid.</span>
                  <div id="tddbuttons">
                   <img id="raidtuto" src="https://aden-rpg.pages.dev/assets/tutorialbtn.webp" style="width:45px; height:45px;">
                    <img id="tddstory" src="https://aden-rpg.pages.dev/assets/tddstart.webp" style="width:47px; height:47px; margin-top: -2px;">
                     
                   </div>
                <img id="tddimg" src="https://aden-rpg.pages.dev/assets/tddbanner.webp" style="width: 90vw; height: 180px; background: none;">
      </div>      
<div id="raidModal" class="modal" style="display:none;">
  <div class="modal-content">
    <span class="close-btn">&times;</span>
    <h3>Torre da Desolação</h3>
    <p>Duração: 15 minutos..</p>
    <p>Ganhe xp, Cristais, Pedras de Refundição, entre outras recompensas, junto com sua guilda.</p>
    <button id="startRaidBtn" class="action-btn">Iniciar Raid</button>
    <button id="cancelRaidBtn" class="action-btn">Cancelar</button>
  </div>
</div>

<div id="raidCombatModal" class="modal" style="display:none;">
  <div class="modal-content">
   <div id="raidCountdownContainer" style="display:none; text-align:center; padding: 40px 10px; color: white;">
        <h1 id="raidCountdownMessage" style="font-size: 1.4em; color: yellow; line-height: 1.5;"></h1>
        <div id="raidCountdownTimer" style="font-size: 3em; font-weight: bold; margin-top: 20px;"></div>
    </div>
   <div id="raidHeader" style="position:relative; display:flex; justify-content:center; align-items:center; padding:8px 0;">
  <div id="raidFloorInfo" style="position:absolute; left:-2px; margin-top: -24px; text-align:center;text-shadow:
        1px 1px 2px black,
        -1px -1px 2px black,
        1px -1px 2px black,
        -1px 1px 2px black, 
        0 0 2px black,
        0 0 4px black;"></div>
  <div id="raidTimerInfo" style="font-weight:bold; font-size:1.1em;"></div>
</div>
<div id="raidBackBtn" style="position:absolute; right:6px; margin-top: -16px; text-align:center;text-shadow:
        1px 1px 2px black,
        -1px -1px 2px black,
        1px -1px 2px black,
        -1px 1px 2px black, 
        0 0 2px black,
        0 0 4px black; font-weight: bold; display: flex; flex-direction: column; align-items: center; justify-content: center;"> <img src="https://aden-rpg.pages.dev/assets/sair.webp" style="width:22px; height: 28px;">
        <small style="font-size: 0.6em;">voltar</small>
        </div>

    <div id="raidMonsterArea">
      <div style="position: relative; width:100%; height: 380px; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center">
      <img id="raidMonsterImage" src="https://aden-rpg.pages.dev/assets/tddandar01.webp" style="width:220px; height: 320px;">
      </div>
      <div id="raidMonsterHpBar">
        <div id="raidMonsterHpFill"></div>
        <span id="raidMonsterHpText"></span>
      </div>
    </div>
   <center> <img id="raidAttackBtn" src="https://aden-rpg.pages.dev/assets/attackbtn.webp" style="width:70px;height:70px;cursor:pointer; margin-top: 9px;"></center>
    <p style="font-size: 0.8em; font-weight: bold; margin-top: -18px">
      Ataques: <span id="raidPlayerAttacks">0</span>
      <button id="raidBuyAttackBtn" class="btn btn-gold" style="vertical-align: -5px">+</button><br>
      <span id="raidAttackCooldown"></span>
    </p>
    
   
  </div>
</div>


<div id="lastRaidResultModal" class="modal" style="display:none;">
    <div class="modal-content">
        <h3>Resultado da Última Raid</h3>
        <p>Na sua última incursão na Torre da Desolação, sua guilda alcançou:</p>
        <h2 id="lastRaidFloorResult" style="color: yellow; font-size: 2em; margin: 10px 0;">Andar 0</h2>
        <button id="startNewRaidFromLastResultBtn" class="action-btn">Iniciar Nova Raid</button>
        <button id="closeLastResultBtn" class="action-btn">Fechar</button>
    </div>
</div>

<div id="raidRewardModal" class="modal" style="display:none; z-index: 12500">
  <div class="modal-content">
    <h3>Recompensa de Andar</h3>
    <p>Você ganhou:</p>
    <p><strong id="rewardXpText" style="color:lime;">0 XP</strong></p>
    <p><strong id="rewardCrystalsText" style="color:cyan;">0 Cristais</strong></p>
    <button id="rewardOkBtn" class="action-btn">Ok</button>
  </div>
</div>


                </div>
            </div>

            <div id="batalhas" class="tab-pane">
                 <center><h3>Batalha de Guilda</h3></center>
              <div id="gvg_1">
               
                <div id="gvgt">
                  <h3 class="gvgt_h3">Batalha por Territórios</h3>
                  <span class="gvgt_desc" style="background-color: rgba(0, 0, 0, 0.5);" onclick="window.location.href='guild_battle.html'"><strong>Registro:</strong> Sexta-feira 21h00.<br><strong>Batalha:</strong> Sábado 21h00.</span>
                  <div id="gvgtbuttons">
                   <img id="gvgttuto" src="https://aden-rpg.pages.dev/assets/tutorialbtn.webp" style="width:45px; height:45px;">
                   </div>
                <img id="gvgtimg" src="https://aden-rpg.pages.dev/assets/gvg_cidades.webp" style="width: 90vw; height: 180px; background: none;" onclick="window.location.href='guild_battle.html'">
      </div>  </div>    
            </div>
        </div>
    </div>

    <div id="createGuildModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h3>Criar Nova Guilda</h3>
            <p>Custo: <strong class="crystals-cost">2000</strong> Cristais</p>
            <p>Nível Mínimo: <strong class="level-min">7</strong></p>
            <input type="text" id="newGuildNameInput" placeholder="Nome da Guilda" maxlength="12">
            <button id="confirmCreateGuildBtn" class="action-btn">Criar</button>
            <p id="createGuildMessage" class="message"></p>
        </div>
    </div>

    <div id="editGuildModal" class="modal" style="display:none;">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <span style="position: fixed; margin-top: 3.7rem; right: 3rem; font-weight: bold; color: gold; font-size: 1.2em;">>>></span>
            <h3>Editar Guilda</h3>

           <div id="editTabMenu" class="tab-scroll">
    <span class="edit-tab-btn" data-tab="tab-edit">Editar</span>
    <span class="edit-tab-btn" data-tab="tab-requests">Solicitações</span>
    <span class="edit-tab-btn" data-tab="tab-manage">Gerenciar</span>
    <span class="edit-tab-btn" data-tab="tab-notice">Quadro de Aviso</span>
    <span class="edit-tab-btn" data-tab="tab-chest">Baú</span>
</div>


            <div id="editTabContent">
                <div id="tab-edit" class="edit-tab-pane" style="display:none;">
                    <label>Nome da Guilda (1x a cada 30 dias):</label>
                    <input type="text" id="editGuildName" maxlength="25">
                    <p id="editNameInfo" class="message"></p>

                    <label>Descrição:</label>
                    <textarea id="editGuildDescription" style="height: 120px; width: 90%;" maxlength="100"></textarea>

                    <label>Bandeira (URL):</label>
                    <input type="text" id="editGuildFlagUrl" placeholder="https://...">

                    <button id="saveGuildChangesBtn" class="action-btn">Salvar Alterações</button>
                </div>

                <div id="tab-requests" class="edit-tab-pane" style="display:none;">
                    <h4>Solicitações Pendentes</h4>
                    <ul id="guildRequestsList"></ul>
                </div>

                <div id="tab-manage" class="edit-tab-pane" style="display:none;">
                    <h4>Gerenciar Membros</h4>
                    <ul id="manageMembersList"></ul>
                </div>

                <div id="tab-notice" class="edit-tab-pane" style="display:none;">
                    <h4>Aviso Atual</h4>
                    <div id="guildNotice" style="padding:8px;border:1px solid #ddd;border-radius:6px;background:#444;"></div>
                    <div id="noticeInfo" style="font-size:0.9em;color:white;margin-top:6px;"></div>
                    <div id="noticeEditor" style="margin-top:8px;display:none;">
                        <textarea id="editGuildNotice" placeholder="Escreva um aviso breve..." maxlength="150" style="height: 120px; width: 85%;"></textarea>
                        <button id="saveGuildNoticeBtn" class="action-btn">Atualizar Aviso</button>
                    </div>
                    <hr style="margin:10px 0;">
                    <h4>Registro de Atividades</h4>
                    <ul id="guildLogsList"></ul>
                </div>

                <div id="tab-chest" class="edit-tab-pane" style="display:none;">
                    <h4>Baú</h4>
                    <p>Em breve.</p>
                </div>
            </div>
        </div>
    </div>

    <div id="searchGuildModal" class="modal" style="display:none;">
      <div class="modal-content">
        <span class="close-btn">&times;</span>
        <h3>Buscar Guilda</h3>
        <input type="text" id="searchGuildInput" placeholder="Nome da guilda...">
        <button id="searchGuildConfirmBtn" class="action-btn">Buscar</button>
        <ul id="searchGuildResults"></ul>
      </div>
    </div>
    <div id="viewGuildModal" class="modal" style="display:none;">
    <div class="modal-content">
        <span class="close-btn" id="viewGuildCloseBtn">&times;</span>
        <div id="guildViewContainer">
            <div id="guildViewHeader" style="display:flex; justify-content:center; align-items:center;"></div>
            <div id="guildViewName" style="text-align: center; font-size: 1.4em;"></div>
            <div style="display: none; text-align: center;">
                <img alt="poder" id="cpIcon" style="width: 28px; height: 37px; vertical-align: -4px;" src="https://aden-rpg.pages.dev/assets/CPicon.webp"/>
                <span id="guildViewPower" style="color:orange; font-weight:bold; font-size:1.7em; margin-top:4px;"></span>
            </div>
            <div id="guildViewDescription" style="margin:6px 0;color:white; font-size: 0.8em; text-align: center;"></div>
            <div style="text-align: center;">
                <span style="color: yellow; font-weight: bold; font-size: 1.3em;">Nv. <span id="guildViewLevelValue"></span></span>
            </div>
            <div class="member-list-container">
                <h4>Membros (<span id="guildViewMemberCountHeader">0</span>)</h4>
                <ul id="guildViewMemberList"></ul>
            </div>
            <div id="guildViewActions" style="text-align: center; margin-top: 20px;">
              
            </div>
        </div>
    </div>
</div>


<div id="playerModal" class="modal" style="display:none; width: 92%;">
  <div class="modal-content">
    <span id="closePlayerModal" class="close-btn">&times;</span>

    <h3 id="playerName">Jogador</h3>
    <div style="position: absolute; top: 12%; display: flex; align-items: center; justify-content: center;" id="playerLevel">Nv. 0</div>

    <div id="equipmentAndAvatarContainer">
      <div class="equipment-column">
        <div id="weapon-slot" class="equipment-slot" data-slot="weapon"></div>
        <div id="ring-slot" class="equipment-slot" data-slot="ring"></div>
        <div id="helm-slot" class="equipment-slot" data-slot="helm"></div>
        <div id="special1-slot" class="equipment-slot" data-slot="special1"></div>
      </div>

      <div id="playerAvatarEquipContainer">
        <div class="guild-header">
          <div style="display: flex;
  flex-direction: column; justify-content: center; text-align: center; align-items: center;">
          <img id="playerGuildFlag" src="https://aden-rpg.pages.dev/assets/guildaflag.webp" alt="Bandeira" onerror="this.style.display='none'">
          <div id="playerGuildName">Nome da Guilda</div>
        </div>
</div>
        <img id="playerAvatarEquip" src="https://via.placeholder.com/100" alt="Avatar do Jogador">
        <div style="display: none; flex-wrap: nowrap; width: 100%; gap: 12px; justify-content: center; text-align: center; align-items: center;">
        <img alt="poder" id="cpIcon" style="width: 18px; height: 30px; vertical-align: 4px; position: relative; margin-top: 3px;" src="https://aden-rpg.pages.dev/assets/CPicon.webp"/><div id="playerCombatPower">0 </div>
      </div>
</div>
      <div class="equipment-column">
        <div id="amulet-slot" class="equipment-slot" data-slot="amulet"></div>
        <div id="wing-slot" class="equipment-slot" data-slot="wing"></div>
        <div id="armor-slot" class="equipment-slot" data-slot="armor"></div>
        <div id="special2-slot" class="equipment-slot" data-slot="special2"></div>
      </div>
    </div>

    <div id="attributesSection">
      <div class="attribute-row">
        <div class="attribute-item">
          <span class="attribute-label">ATK</span>
          <span id="playerAttack" class="attribute-value">0 - 0</span>
        </div>
        <div class="attribute-item">
          <span class="attribute-label">TAXA CRIT</span>
          <span id="playerCritChance" class="attribute-value">0%</span>
        </div>
        <div class="attribute-item">
          <span class="attribute-label">DANO CRIT</span>
          <span id="playerCritDamage" class="attribute-value">0%</span>
        </div>
      </div>

      <div class="attribute-row">
        <div class="attribute-item">
          <span class="attribute-label">HP</span>
          <span id="playerHealth" class="attribute-value">0</span>
        </div>
        <div class="attribute-item">
          <span class="attribute-label">DEFESA</span>
          <span id="playerDefense" class="attribute-value">0</span>
        </div>
        <div class="attribute-item">
          <span class="attribute-label">EVASÃO</span>
          <span id="playerEvasion" class="attribute-value">0%</span>
        </div>
      </div>
    </div>
    <div style="display: flex; justify-content: center; align-items: center;">
      <button id="sendmp" style="display: none; text-align: center; display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 1em; padding: 0 0;"><img src="https://aden-rpg.pages.dev/assets/iconsender.webp" style="width: 35px; height: 35px;"> Enviar Mensagem</button> 
    </div>
  </div>
</div>
<div id="buyModal" class="modal" style="display: none; z-index: 13501;">
  <div class="modal-content">
    <h3>Confirmar Compra</h3>
    <p id="buyPlayerGoldInfo"><img src="https://aden-rpg.pages.dev/assets/goldcoin.webp" style="width: 17px; height: 17px"></p>
    <p>Os ataques comprados só poderão ser usados na Raid atual.</p>

    <p>Quantidade de ataques:</p>
    <div style="display: flex; justify-content: center; align-items: center; gap: 35px;">
      <div style="background: #333; border-radius: 8px; border: white; width: 140px; display:flex; justify-content: center; align-items: center;">
        <button id="buyDecreaseQtyBtn" class="action-btn">-</button>
        <span id="buyAttackQty" style="font-size: 2em; color: yellow; margin: 0 12px;">1</span>
        <button id="buyIncreaseQtyBtn" class="action-btn">+</button>
      </div>
    </div>
    <p id="buyAttackCostInfo">Custo total: 0 Ouro</p>
    <div style="display: flex; justify-content: space-around; margin-top: 20px;">
      <button id="buyCancelBtn" class="action-btn confirmabuy-btn">Cancelar</button>
      <button id="buyConfirmBtn" class="action-btn confirmabuy-btn">Confirmar</button>
    </div>
  </div>
</div>


<div id="raidAlertModal" class="modal" style="display:none; z-index:15000; align-items: center; justify-content: center;">
  <div class="modal-content">
    <h3>Aviso</h3>
    <p id="raidAlertMessage"></p>
    <button id="raidAlertOkBtn" class="action-btn">OK</button>
  </div>
</div>

<div id="tutorialModaltav" class="modal-overlay2" style="display: none; height: 650px!important;">
        <div class="modal-content2">
           <center><h3 style="color: white;">Taverna da Guilda</h3></center>
<p>A taverna é o local onde os membros da guilda se reúnem para conversar e trocar informações.</p>
<p><strong>Dica:</strong> A Taverna não é necessariamente um chat ativo, pois tem um tempo mínimo para envio de mensagens e um limite de histórico antigo. Use-a para deixar recados importantes.</p>
<center><button id="closetavTutorialBtn" class="action-btn">Fechar</button></center>
</div></div>

<div id="tutorialModalRaid" class="modal-overlay2" style="display: none;">
        <div class="modal-content2">
           <center><h3>Guia Completo da Torre da Desolação (Raid)</h3></center>
<p>A Torre da Desolação (Raid) é um desafio cooperativo onde sua Guilda deve trabalhar em conjunto para derrotar monstros em andares progressivamente mais difíceis e conquistar recompensas.</p>
            <hr>
<center><h4>1. Início da Raid</h4></center>
<p>A Raid não é automática. Ela precisa ser iniciada por alguém na sua Guilda.</p>
<ul>
<li><strong>Quem Inicia:</strong> Apenas o <strong>Líder</strong> ou <strong>Co-Líder</strong> da Guilda pode começar a Raid.</li>
<li><strong>Quando Iniciar:</strong> A Raid só pode ser iniciada <strong>Segunda, Quarta e Sexta-feira</strong>.</li>
<li><strong>Frequência:</strong> Sua Guilda pode iniciar a Raid <strong>apenas uma vez por dia</strong>.</li>
<li><strong>Preparo:</strong> Ao ser iniciada, a <strong>Vida</strong> de <strong>todos os membros</strong> da Guilda é instantaneamente restaurada ao máximo.<br>
O tempo de preparação é de 10 minutos.</li></ul>
            <hr>
<center><h4>2. Ataques e Tentativas</h4></center>
<p>Sua capacidade de ataque é limitada e se recupera com o tempo.</p>
<ul>
<li><strong>Limite de Ataques:</strong> Você pode acumular um máximo de <strong>3 ataques</strong> disponíveis de uma vez.</li>
<li><strong>Recuperação:</strong> Você recupera <strong>1 ataque</strong> a cada <strong>60 segundos</strong> (1 minuto).</li>
<li><strong>Comprando Ataques Extras (Ouro):</strong> O preço aumenta progressivamente a cada 5 ataques comprados no dia. O custo reseta diariamente.</li>
</ul>
<hr>
<center><h4>3. Batalhas de Chefe e Morte</h4></center>
<p>A cada 5 andares, você enfrentará o Imperador Veinur que ataca.</p>
<p>O Imperador Veinur consegue te ver através de seus servos e irá interagir falando com você durante toda a Raid.</p>
<ul>
<li><strong>Andares de Chefe:</strong> O Imperador Veinur aparece nos andares múltiplos de 5 (Andar 5, Andar 10, etc.).</li>
<li><strong>Ataque do Chefe:</strong> O Imperador Veinur ataca <strong>todos</strong> os jogadores ativos na Raid a cada <strong>30 segundos</strong>.</li>
<li><strong>Habilidades do Chefe:</strong> O Imperador Veinur possui duas habilidades:<br><strong>Aura Maligna</strong>: uma chance de Veinur restaurar parte do HP de seus servos.<br><strong>Morte Súbita</strong>: uma chance de Veinur matar um ou mais jogadores instantaneamente <i>(o tempo de reviver é menor, 20 segundos)</i>.</li>
<li><strong>Morte em Raid e Reviver:</strong> Se sua <strong>Vida</strong> chegar a zero, você é derrotado. Após um período de espera, sua Vida é restaurada ao máximo, permitindo que você retorne.</li>
</ul>
<hr>
<center><h4>4. Recompensas e Progresso</h4></center>
<p>O trabalho em equipe é a chave para as recompensas e o avanço.</p>
<ul>
<li><strong>Recompensas:</strong> Você recebe <strong>Cristais</strong> e <strong>Experiência (XP)</strong> proporcionais ao seu dano total no monstro.<br>A guilda também ganha XP.<br>Há chance de receber outros <strong>Itens</strong> como recompensa.</li>
<li><strong>Avanço:</strong> Após derrotar o monstro, o ranking de dano é zerado e a Guilda avança para o próximo andar.</li>
<li><strong>Fim da Raid:</strong> A Torre da Desolação é concluída após o <strong>Andar 40</strong> ou após o tempo de <strong>15 minutos</strong>.</li>
</ul>
<p>Acompanhe sua vida e use seus ataques com sabedoria para maximizar sua contribuição! </p>
<center><button id="closeRaidTutorialBtn" class="action-btn">Fechar</button></center>
        </div>
    </div>
    <div id="tddModalStory" class="modal-overlay2" style="display: none;">
    <div class="modal-content2">
        <div id="videoContainer">
            <iframe 
                id="tddStoryVideo"
                width="100%" 
                height="100%" 
                src="https://www.youtube.com/embed/c7NZ7wrpTSM?autoplay=0&controls=1&modestbranding=1&rel=0" 
                frameborder="0" 
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; picture-in-picture" 
                allowfullscreen>
            </iframe>
        </div>
        
        <center><button id="closetddstoryBtn" class="action-btn">Fechar</button></center>       
    </div>
</div>

<div id="tutorialModalgvgt" class="modal-overlay2" style="display: none;">
    <div class="modal-content2">
        <center><h3>Guia Completo da Batalha por Territórios</h3></center>
        <p>Seja bem-vindo, guerreiro! A Batalha por Territórios é um evento de guilda, onde o poder e a estratégia da sua aliança decidem o controle de cidades vitais.</p>
        <hr>

        <center><h4>1. Fase de Registro</h4></center>
        <p>A Batalha por Territórios ocorre semanalmente. Sua guilda deve se registrar para desafiar uma cidade:</p>
        <ul>
            <li><strong>Prazo Final:</strong> O registro abre no <strong>Sábado à meia-noite UTC (21:00 de Sexta-feira no Brasil)</strong> e fecha <strong>24 horas depois</strong>.</li>
            <li><strong>Limite de Desafios:</strong> Apenas 5 guildas podem se registrar para disputar cada cidade.</li>
            <li><strong>Ação Necessária:</strong> Um líder ou co-líder da guilda deve escolher a cidade para o registro.</li>
        </ul>
        
        <center><h4>1.2 Combate</h4></center>
        <p>A batalha começa no <strong>Domingo à meia-noite UTC (21:00 de Sábado no Brasil)</strong> e tem duração de <strong>24 horas</strong>.</p>
<hr>
        <center><h4>2. O Campo de Batalha</h4></center>
        <p>Cada cidade possui <strong>5 Objetivos</strong> que devem ser atacados e dominados para acumular <strong>Pontos de Honra</strong>:</p>
        <ul>
            <li><strong>O Nexus (1 Ponto):</strong> Objetivo central, com 300.000 HP.</li>
            <li><strong>Pontos de Controle (4 Pontos):</strong> Objetivos secundários, cada um com 100.000 HP.</li>
        </ul>
        <p>A guilda com mais Pontos de Honra no final da batalha vence e conquista a cidade.</p>
        <hr>

        <center><h4>3. Ações de Batalha e Combate</h4></center>
        <p>Sua participação é limitada por <strong>Ações de Batalha</strong>:</p>
        <ul>
            <li><strong>Limite Máximo:</strong> Você pode acumular um máximo de <strong>5 Ações</strong>.</li>
            <li><strong>Recuperação:</strong> Você recupera <strong>1 Ação</strong> a cada <strong>60 minutos</strong> (1 hora).</li>
            <li><strong>Modo Frenético:</strong> Quando faltarem 20 minutos para o fim da batalha, o <strong style="color:orange;">Modo Frenético</strong> é ativado e você passa a recuperar <strong>1 Ação</strong> a cada <strong>60 segundos</strong> (1 minuto).</li>
            <li><strong>Comprando Ações:</strong> Você pode comprar reforços com Ouro (Pacote 1: 3 Ações / Pacote 2: 5 Ações).</li>
        </ul>
        <p>Você pode usar suas ações de duas formas:</p>
        <ul>
            <li><strong>ATACAR (Custo: 1 Ação):</strong> Causa dano ao objetivo. O dano primeiro atinge a Guarnição dos inimigos e só depois o HP principal do Objetivo.</li>
            <li><strong>GUARNECER (Custo: 1 Ação):</strong> Junta-se à Guarnição de um Objetivo dominado pela sua guilda, aumentando o HP de defesa do ponto.</li>
        </ul>
        <hr>

        <center><h4>4. Captura e Pontuação</h4></center>
        <p>Ao zerar o HP principal de um Objetivo, a guilda que causou o maior dano total o captura e ganha Honra:</p>
        <ul>
            <li><strong>Captura do Nexus:</strong> <strong>+300 Pontos de Honra</strong> distribuídos entre as guildas que atacaram de acordo com seu dano.</li>
            <li><strong>Captura de Ponto de Controle:</strong> <strong>+100 Pontos de Honra</strong> distribuídos entre as guildas que atacaram de acordo com seu dano.</li>
            <li><strong>Perda:</strong> A guilda que perde o objetivo é penalizada na mesma quantidade de Honra.</li>
        </ul>
        <hr>

        <center><h4>5. Recompensas</h4></center>
        <p>As recompensas são distribuídas para as guildas que terminarem nas 3 primeiras posições e apenas para os jogadores que participaram ativamente (causaram dano):</p>
        <table style="width: 100%; border-collapse: collapse; text-align: left; color: white;">
            <thead>
                <tr>
                    <th style="padding: 5px; border-bottom: 1px solid #444;">Classificação</th>
                    <th style="padding: 5px; border-bottom: 1px solid #444;">Recompensas</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="padding: 5px;"><strong>1º Lugar</strong></td>
                    <td style="padding: 5px;">8 Cartões de Espiral Avançado, 80 Pedras de Refundição e 6000 Cristais.</td>
                </tr>
                <tr>
                    <td style="padding: 5px;"><strong>2º Lugar</strong></td>
                    <td style="padding: 5px;">12 Cartões de Espiral Comum, 40 Pedras de Refundição e 2000 Cristais.</td>
                </tr>
                <tr>
                    <td style="padding: 5px;"><strong>3º Lugar</strong></td>
                    <td style="padding: 5px;">8 Cartões de Espiral Comum, 20 Pedras de Refundição e 1000 Cristais.</td>
                </tr>
            </tbody>
        </table>
        <p>O jogador top 1 de dano terá suas recompensas triplicadas.<br>
        O jogador top 2 de dano terá suas recompensas duplicadas.</p>

        <p>Participe, planeje seus ataques e guarnições para levar sua guilda à vitória!</p>
        <center><button id="closegvgtTutorialBtn" class="action-btn">Fechar</button></center>
    </div>
</div>


<script>
        document.addEventListener("DOMContentLoaded", () => {
            const tavtutoImg = document.getElementById("tavtuto");
            const tutorialModal = document.getElementById("tutorialModaltav");
            const closetavTutorialBtn = document.getElementById("closetavTutorialBtn");

            if (tavtutoImg) {
                tavtutoImg.addEventListener("click", () => {
                    tutorialModaltav.style.display = "flex";
                });
            }

            if (closetavTutorialBtn) {
                closetavTutorialBtn.addEventListener("click", () => {
                    tutorialModaltav.style.display = "none";
                });
            }

            if (tutorialModaltav) {
                window.addEventListener("click", (event) => {
                    if (event.target === tutorialModaltav) {
                        tutorialModaltav.style.display = "none";
                    }
                });
            }
        });
    </script>
    
     <script>
        document.addEventListener("DOMContentLoaded", () => {
            const raidtutoImg = document.getElementById("raidtuto");
            const tutorialModal = document.getElementById("tutorialModalRaid");
            const closeRaidTutorialBtn = document.getElementById("closeRaidTutorialBtn");

            if (raidtutoImg) {
                raidtutoImg.addEventListener("click", () => {
                    tutorialModalRaid.style.display = "flex";
                });
            }

            if (closeRaidTutorialBtn) {
                closeRaidTutorialBtn.addEventListener("click", () => {
                    tutorialModalRaid.style.display = "none";
                });
            }

            if (tutorialModalRaid) {
                window.addEventListener("click", (event) => {
                    if (event.target === tutorialModalRaid) {
                        tutorialModalRaid.style.display = "none";
                    }
                });
            }
        });
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const gvgttutoImg = document.getElementById("gvgttuto");
            const tutorialModalgvgt = document.getElementById("tutorialModalgvgt");
            const closegvgtTutorialBtn = document.getElementById("closegvgtTutorialBtn");

            if (gvgttutoImg) {
                gvgttutoImg.addEventListener("click", () => {
                    tutorialModalgvgt.style.display = "flex";
                });
            }

            if (closegvgtTutorialBtn) {
                closegvgtTutorialBtn.addEventListener("click", () => {
                    tutorialModalgvgt.style.display = "none";
                });
            }

            if (tutorialModalgvgt) {
                window.addEventListener("click", (event) => {
                    if (event.target === tutorialModalgvgt) {
                        tutorialModalgvgt.style.display = "none";
                    }
                });
            }
        });
    </script>

  <script>
        document.addEventListener("DOMContentLoaded", () => {
            const tddstory = document.getElementById("tddstory");
            const tddstorymodal = document.getElementById("tddModalStory");
            const closetddstoryBtn = document.getElementById("closetddstoryBtn");

            if (tddstory) {
                tddstory.addEventListener("click", () => {
                    tddstorymodal.style.display = "flex";
                });
            }

            if (closetddstoryBtn) {
                closetddstoryBtn.addEventListener("click", () => {
                    tddstorymodal.style.display = "none";
                });
            }

            if (tddstorymodal) {
                window.addEventListener("click", (event) => {
                    if (event.target === tddstorymodal) {
                        tddstorymodal.style.display = "none";
                    }
                });
            }
        });
    </script>
    

<div id="banModalOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.95); color: white; z-index: 10000; justify-content: center; align-items: center; text-align: center; flex-direction: column;">
    <div style="background: #2b2b2b; padding: 30px; border-radius: 15px; box-shadow: 0 0 25px rgba(255, 69, 0, 0.8); max-width: 90%; width: 400px; border: 3px solid #ff4500;">
        <img src="https://aden-rpg.pages.dev/assets/expulsar.webp" alt="Aviso" style="width: 80px; height: 80px; margin-bottom: 10px;">
        <h2 style="color: #ff4500; font-size: 1.8em; margin-bottom: 20px;">Você foi banido(a)!</h2>
        
        <p style="text-align: left; margin-bottom: 25px;">
            <strong>Motivo:</strong><br>
            <span id="banReasonContent" style="color: #ffd700; display: block; margin-top: 5px; padding: 10px; border: 1px dashed #444; white-space: pre-wrap;">[Carregando Motivo...]</span>
        </p>

        <button id="logoutBanBtn" style="background: linear-gradient(to top, #ff4500, #ff8c00); color: white; padding: 12px 25px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 1.1em; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3); transition: background 0.2s;">
            Fechar
        </button>
    </div>
</div>


<div id="maintenance-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.9); color: white; z-index: 99999; justify-content: center; align-items: center; text-align: center; flex-direction: column; font-family: Arial, sans-serif;">
    <img src="https://aden-rpg.pages.dev/assets/config.webp" alt="Manutenção" style="width: 120px; height: 120px; margin-bottom: 20px;">
    <h1 id="maintenance-title">Aviso de Manutenção</h1>
    <p id="maintenance-message" style="font-size: 1.1em; max-width: 80%;"></p>
    <p style="font-size: 0.9em; margin-top: 20px;">Obrigado pela sua paciência.</p>
</div>
<div id="countdown-banner" style="display: none; position: fixed; top: 0; left: 0; width: 100%; padding: 10px; background-color: rgba(0, 0, 0, 0.9); color: white; text-align: center; z-index: 9999; font-family: Arial, sans-serif; box-shadow: 0 4px 8px rgba(0,0,0,0.3); font-weight: bold;">
    <div style="font-size: 1.5em; font-weight: bold;">
        <span id="countdown-timer"></span>
    </div>
    <div style="font-size: 0.9em; margin-top: 5px;">
        O servidor entrará em manutenção dentro de instantes. Por favor, não inicie alguma operação no jogo para não ter risco de perda de dados. Obrigado pela paciência!
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  // cria um elemento para medir o tamanho real de 1rem
  const testEl = document.createElement("div");
  testEl.style.cssText = "position:absolute;visibility:hidden;font-size:1rem;line-height:1;";
  testEl.textContent = "M";
  document.body.appendChild(testEl);

  const actualRem = testEl.getBoundingClientRect().height;
  document.body.removeChild(testEl);

  console.log("[scale-lock] 1rem real:", actualRem, "px");

  // queremos sempre 16px como base (modo padrão)
  const targetRem = 16;
  const correction = targetRem / actualRem;

  const style = document.createElement("style");
  style.textContent = `
    html { font-size: ${16 * correction}px !important; }
    body { font-size: 1.5rem !important; }
  `;
  document.head.appendChild(style);

  console.log("[scale-lock] Correção aplicada, fator:", correction.toFixed(2));
});
</script>


 <script type="module" src="guild_raid.js"></script>
<script src="loading.js"></script>
   <script src="number_format.js"></script>
    <script src="guild.js"></script>
    <script type="module" src="playerModal.js"></script>
<script src="guild_pv.js"></script>
<script>
document.addEventListener("DOMContentLoaded", () => {
    
    // --- Configurações ---
    const KEY_TAB_SAT = 'aden_guild_tab_seen_saturday';
    // Removemos KEY_TAB_SUN pois domingo agora é baseado puramente no horário
    
    const batalhasTab = document.querySelector('.tab-btn[data-tab="batalhas"]');

    // --- 1. Lógica Visual (Rodada ao carregar e no Intervalo) ---
    function checkGuildTabNotification() {
        if (!batalhasTab) return;

        const now = new Date();
        const day = now.getUTCDay(); // 0=Dom, 6=Sab, 1=Seg
        const hours = now.getUTCHours();
        const minutes = now.getUTCMinutes();

        let showDot = false;

        // Limpeza na Segunda-feira
        if (day === 1) {
            localStorage.removeItem(KEY_TAB_SAT);
            const dot = batalhasTab.querySelector('.tab-notification-dot');
            if (dot) dot.remove();
            return;
        }

        // Verifica Sábado (Lógica Padrão: Verifica Storage)
        if (day === 6) {
            if (!localStorage.getItem(KEY_TAB_SAT)) {
                showDot = true;
            }
        }

        // Verifica Domingo (Lógica Persistente: Horário 00:01 - 23:59)
        else if (day === 0) {
            // Início: 00:01 | Fim: 23:58:59
            const isAfterStart = (hours === 0 && minutes >= 1) || hours > 0;
            const isBeforeEnd = (hours < 23) || (hours === 23 && minutes < 59);

            if (isAfterStart && isBeforeEnd) {
                showDot = true; // Força true, ignora storage
            }
        }

        // Renderização
        const existingDot = batalhasTab.querySelector('.tab-notification-dot');
        
        if (showDot) {
            if (!existingDot) {
                const dot = document.createElement('div');
                dot.className = 'tab-notification-dot';
                batalhasTab.appendChild(dot);
            }
        } else {
            // Se showDot virou false (ex: virou 23:59 UTC de domingo), removemos
            if (existingDot) existingDot.remove();
        }
    }

    // --- 2. Evento de Clique (Definido apenas uma vez) ---
    if (batalhasTab) {
        batalhasTab.addEventListener('click', () => {
            const now = new Date();
            const day = now.getUTCDay();

            // Se for Sábado: Comportamento padrão (salva visto e remove bolinha)
            if (day === 6) {
                localStorage.setItem(KEY_TAB_SAT, 'true');
                const dot = batalhasTab.querySelector('.tab-notification-dot');
                if (dot) dot.remove();
            }

            // Se for Domingo (day === 0): 
            // NÃO faz nada. A bolinha continua lá visualmente e não salvamos nada.
            // Ela sumirá sozinha quando checkGuildTabNotification detectar 23:59 UTC.
        });
    }

    // --- 3. Inicialização e Loop ---
    checkGuildTabNotification();

    // Verifica a cada minuto para atualizar automaticamente (importante para remover às 23:59 de domingo)
    setInterval(checkGuildTabNotification, 60000);
});
</script>
</body>
<script defer type="module" src="guild_tavern.js"></script>

<div id="google_translate_element"></div>

<script src="auto_translate.js"></script>

<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
<script>
(function() {
    const MUSIC_MUTE_KEY = 'backgroundMusicMuted';
    const isGloballyMuted = localStorage.getItem(MUSIC_MUTE_KEY) === 'true';

    // Lista de URLs de MÚSICA DE FUNDO (BGM)
    // Se o URL do áudio criado contiver qualquer uma dessas strings, ele será mutado.
    const BGM_URL_FRAGMENTS = [
        '/assets/music_loop_02.mp3', // Índice principal
        '/assets/idlesong.mp3',      // afk_page.js
        '/assets/combat_afk_bg.mp3', // afk_page.js
        '/assets/mina.mp3',
        '/assets/desolation_tower.mp3',
        '/assets/arena.mp3',
        // mines.js
        // ADICIONE AQUI FRAGMENTOS DE URL DE QUALQUER OUTRA MÚSICA DE FUNDO
        // Ex: '/assets/arena_bgm.mp3', '/assets/raid_bgm.mp3'
    ];

    // Guarda o construtor original
    const OriginalAudio = window.Audio;

    // Se o mute não estiver ativo, ou se já interceptamos, não faça nada.
    if (!isGloballyMuted || OriginalAudio.__isPatched) {
        return;
    }

    // Sobrescreve o construtor nativo
    window.Audio = function(src) {
        // 1. Cria o objeto de áudio usando o construtor original
        const audioInstance = new OriginalAudio(src);

        // 2. Verifica se o 'src' corresponde a um BGM
        const isBGM = src && BGM_URL_FRAGMENTS.some(fragment => src.includes(fragment));

        if (isBGM) {
            // 3. Se for BGM e o mute estiver ativo, força o volume para 0.
            audioInstance.volume = 0;
            // console.log(`[MUTE PATCH] Muted BGM: ${src}`); // Opcional para debug

            // 4. Adiciona um 'setter' falso para a propriedade 'volume' do objeto
            // Isso previne que seus scripts de página (ex: combatMusic.volume = 0.4;)
            // consigam desmutar o áudio posteriormente.
            Object.defineProperty(audioInstance, 'volume', {
                get() {
                    return 0; // Sempre retorna 0
                },
                set(newValue) {
                    // Se o valor for 0 (mutar) ou o valor antigo for 0, permite que o script original
                    // defina o volume, mas mantemos o nosso em 0.
                    // Isso é para o caso de o usuário querer restaurar o volume no futuro.
                    if (newValue > 0 && isGloballyMuted) {
                        // console.warn(`[MUTE PATCH] Tentativa de desmutar BGM bloqueada. Estado global: Mutado.`);
                    }
                    // O objeto de áudio real continua mutado (volume = 0)
                },
                configurable: true // Permite que seja redefinido se o estado mudar
            });

        }

        // 5. Retorna a instância (mutada ou não)
        return audioInstance;
    };
    
    // Marca o construtor como modificado
    window.Audio.__isPatched = true;
    
    // Opcional: Se o botão de toggle for clicado para desmutar, precisamos restaurar a função
    // O script do index.html (que tem o toggle) pode usar o window.applyGlobalMuteToMusic.

})();
</script>

<div id="leftSideMenu">
    <div class="menu-header">
        <button id="closeMenuBtn" class="close-menu-btn">
             </button>
        <h3>Menu</h3>
        <div style="width: 28px;"></div> 
    </div>
    <ul id="menuList" class="menu-list">
        </ul>
</div>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    // --- CONFIGURAÇÃO MANUAL ---
    // Mude isso em cada arquivo (ex: "mines.html", "capital.html", "afk.html")
    const MANUAL_CURRENT_PAGE = "guild.html"; 

    const assetBase = "https://aden-rpg.pages.dev/assets/";

    const menuItems = [
        { name: "Tela inicial", url: "index.html", icon: assetBase + "homeic.webp" },
        { name: "Aventura AFK", url: "afk.html", icon: assetBase + "expm.webp", key: 'afk' },
        { name: "Mineração", url: "mines.html", icon: assetBase + "recursos.webp" }, 
        { name: "Arena PvP", url: "arena.html", icon: assetBase + "pvp.webp", key: 'arena' },
        { name: "Chefe Mundial", url: "solo_boss.html", icon: assetBase + "bossm.webp", key: 'boss' },
        { name: "Guilda", url: "guild.html", icon: assetBase + "guilda.webp", key: 'guild' },
        { name: "Bolsa", url: "inventory.html", icon: assetBase + "iconbolsa.webp" },
        { name: "Ranking", url: "ranking_cp.html", icon: assetBase + "iconranking.webp" },
        { name: "Títulos", url: "titulos.html", icon: assetBase + "icontitulos.webp" },
        { name: "Resgate", url: "resgate.html", icon: assetBase + "resgate.webp" },
        
        // --- NOVO MENU CIDADES (DROPDOWN) ---
        { 
            name: "Cidades", 
            icon: assetBase + "mapicon.webp",
            isDropdown: true, // Flag para indicar que é dropdown
            subItems: [
                { name: "Capital", url: "capital.html" },
                { name: "Astrax", url: "astrax.html" },
                { name: "Duratar", url: "duratar.html" },
                { name: "Elendor", url: "elendor.html" },
                { name: "Mitrar", url: "mitrar.html" },
                { name: "Tandra", url: "tandra.html" },
                { name: "Zion", url: "zion.html" }
            ]
        }
    ];

    const menuList = document.getElementById("menuList");
    const sideMenu = document.getElementById("leftSideMenu");
    const overlay = document.getElementById("sideMenuOverlay");
    const openBtn = document.getElementById("menuToggleBtn");
    const closeBtn = document.getElementById("closeMenuBtn");

    const hamburgerSVG = `
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
    `;
    
    // Ícone de Seta para baixo (Chevron Down)
    const chevronDownSVG = `
        <svg class="dropdown-arrow" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
    `;

    if(closeBtn) closeBtn.innerHTML = hamburgerSVG;

    if (menuList) {
        menuList.innerHTML = ""; 

        menuItems.forEach(item => {
            const li = document.createElement("li");
            li.className = "menu-item";

            // === CASO 1: É UM MENU DROPDOWN (CIDADES) ===
            if (item.isDropdown) {
                // Verifica se alguma sub-página é a atual (para abrir o menu automaticamente)
                const isSubItemActive = item.subItems.some(sub => sub.url === MANUAL_CURRENT_PAGE);
                
                // Link principal do Dropdown (apenas abre/fecha)
                const a = document.createElement("a");
                a.className = "menu-link dropdown-toggle";
                a.style.cursor = "pointer";
                a.innerHTML = `
                    <img src="${item.icon}" class="menu-icon" alt="ícone" onerror="this.style.display='none'">
                    <span>${item.name}</span>
                    ${chevronDownSVG}
                `;

                // Container dos Sub-itens
                const subUl = document.createElement("ul");
                subUl.className = `submenu-list ${isSubItemActive ? 'open' : ''}`; // Abre se estiver dentro

                if(isSubItemActive) li.classList.add('dropdown-active');

                // Toggle ao clicar no pai
                a.addEventListener("click", (e) => {
                    e.preventDefault();
                    e.stopPropagation(); // Não fecha o menu lateral
                    subUl.classList.toggle("open");
                    li.classList.toggle("dropdown-active");
                });

                // Renderiza os Sub-itens
                item.subItems.forEach(sub => {
                    const isMatch = (sub.url === MANUAL_CURRENT_PAGE);
                    const subLi = document.createElement("li");
                    subLi.className = `menu-item ${isMatch ? 'active' : ''}`; // Aplica active no li filho

                    const subA = document.createElement("a");
                    subA.className = "menu-link submenu-link"; // Classe extra para padding
                    subA.innerHTML = `<span>${sub.name}</span>`; // Sub-itens sem ícone por enquanto

                    if (isMatch) {
                        // Bloqueio Total (igual ao código anterior)
                        subA.removeAttribute("href");
                        subA.style.cursor = "default";
                        subA.style.pointerEvents = "none";
                        subA.style.opacity = "1";
                        subA.addEventListener("click", (e) => {
                            e.preventDefault();
                            e.stopImmediatePropagation();
                            return false;
                        }, true);
                    } else {
                        subA.href = sub.url;
                        subA.addEventListener("click", () => {
                            setTimeout(closeMenu, 100);
                        });
                    }

                    subLi.appendChild(subA);
                    subUl.appendChild(subLi);
                });

                li.appendChild(a);
                li.appendChild(subUl);

            } else {
                // === CASO 2: É UM MENU NORMAL ===
                const isMatch = (item.url === MANUAL_CURRENT_PAGE);
                if(isMatch) li.classList.add('active');

                const a = document.createElement("a");
                a.className = "menu-link";
                a.dataset.menuKey = item.key || '';

                a.innerHTML = `
                    <img src="${item.icon}" class="menu-icon" alt="ícone" onerror="this.style.display='none'">
                    <span>${item.name}</span>
                `;

                if (isMatch) {
                    a.removeAttribute("href");
                    a.style.cursor = "default";
                    a.style.pointerEvents = "none";
                    a.style.opacity = "1";
                    a.addEventListener("click", (e) => {
                        e.preventDefault();
                        e.stopImmediatePropagation();
                        return false;
                    }, true);
                } else {
                    a.href = item.url;
                    a.addEventListener("click", () => {
                         setTimeout(closeMenu, 100);
                    });
                }
                li.appendChild(a);
            }

            menuList.appendChild(li);
        });
    }

    // --- FUNÇÕES DE CONTROLE DO MENU ---
    const toggleMenuRotation = (isOpening) => {
        if (!openBtn) return;
        const svg = openBtn.querySelector('svg');
        if (svg) {
            if (isOpening) svg.classList.add('icon-vertical');
            else svg.classList.remove('icon-vertical');
        }
    };

    const openMenu = () => {
        if(!sideMenu) return;
        sideMenu.classList.add("open");
        if(overlay) overlay.style.display = "block";
        toggleMenuRotation(true);
        setTimeout(() => {
            if(overlay) {
                overlay.style.opacity = "1";
                overlay.style.pointerEvents = "auto";
            }
        }, 10);
    };

    const closeMenu = () => {
        if(!sideMenu) return;
        sideMenu.classList.remove("open");
        if(overlay) {
            overlay.style.opacity = "0";
            overlay.style.pointerEvents = "none";
        }
        toggleMenuRotation(false);
        setTimeout(() => {
            if(overlay) overlay.style.display = "none";
        }, 300);
    };

    if(openBtn) openBtn.addEventListener("click", openMenu);
    if(closeBtn) closeBtn.addEventListener("click", closeMenu);
    if(overlay) overlay.addEventListener("click", closeMenu);

    // --- RENDERIZAR NOTIFICAÇÕES (Mantido igual) ---
    const renderSideMenuNotifications = () => {
        const STORAGE_KEY_ACTIONS = 'aden_daily_actions_status';
        let dailyStatus = {};
        try { dailyStatus = JSON.parse(localStorage.getItem(STORAGE_KEY_ACTIONS) || '{}'); } catch(e) {}

        let showGuildDot = false;
        const now = new Date();
        const day = now.getUTCDay(); 
        const hours = now.getUTCHours();
        const minutes = now.getUTCMinutes();
        const KEY_SAT = 'aden_guild_notif_seen_saturday';
        const KEY_SUN = 'aden_guild_notif_seen_sunday';

        if (day === 1) { 
             localStorage.removeItem(KEY_SAT); 
             localStorage.removeItem(KEY_SUN); 
        }
        if (day === 6 && !localStorage.getItem(KEY_SAT)) showGuildDot = true;
        if (day === 0 && (hours === 00 && minutes >= 01) && !localStorage.getItem(KEY_SUN)) showGuildDot = true;

        const links = menuList.querySelectorAll('.menu-link');
        links.forEach(link => {
            const key = link.dataset.menuKey;
            let shouldShow = false;

            if (key && dailyStatus[key] === true) shouldShow = true;
            if (key === 'guild' && showGuildDot) shouldShow = true;

            const existingDot = link.querySelector('.menu-notification-dot');
            if (existingDot) existingDot.remove();

            if (shouldShow) {
                const dot = document.createElement('div');
                dot.className = 'menu-notification-dot';
                link.appendChild(dot);
            }
        });
    };

    renderSideMenuNotifications();
});
</script>
<script>
(function() {
    const style = document.createElement('style');

    style.innerHTML = `
        /* Animação de movimento (serve para ambos) */
        @keyframes shine {
            0% { background-position: -200% center; }
            100% { background-position: 200% center; }
        }

        /* --- 1. ESTILO DOS NOBRES (Brilho Azul/Ouro - Intacto) --- */
        .shiny-icon {
            display: inline-block;
            background: linear-gradient(
                120deg, 
                #add8e6 0%, 
                #2b4bf2 30%, 
                #ffffff 40%, 
                #2b4bf2 50%, 
                #add8e6 80%
            );
            background-size: 200% auto;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            color: transparent;
            animation: shine 8s linear infinite;
            font-weight: 900;
            font-size: 1.2em;
            line-height: 1;
            vertical-align: middle;
            text-shadow: none !important;
        }

        /* --- 2. ESTILO DO JESTER (Palhaço + Fumaça Marrom) --- */
        .jester-icon {
            display: inline-block;
            position: relative; 
            font-size: 1.4em;
            line-height: 1;
            vertical-align: middle;
            text-shadow: none !important;
            
            /* Garante que o emoji original seja visto normalmente */
            color: inherit !important;
            -webkit-text-fill-color: inherit !important;
        }

        /* A "Fumaça/Sujeira" que passa por cima */
        .jester-icon::after {
            content: attr(data-text);
            position: absolute;
            left: 0;
            top: 0;
            pointer-events: none;
            
            /* Texto transparente para mostrar apenas o fundo (a fumaça) */
            color: transparent;
            -webkit-text-fill-color: transparent;
            
            /* Gradiente de Fumaça: Transparente -> Marrom/Cinza -> Transparente */
            background: linear-gradient(
                120deg, 
                transparent 25%, 
                rgba(101, 67, 33, 0.4) 40%,   /* Marrom Escuro (Dark Brown) bem suave */
                rgba(139, 69, 19, 0.7) 50%,   /* Marrom Terra (Saddle Brown) mais forte */
                rgba(80, 80, 80, 0.5) 60%,    /* Cinza fuligem */
                transparent 75%
            );
            background-size: 200% auto;
            
            /* Recorta a fumaça no formato do emoji */
            -webkit-background-clip: text;
            background-clip: text;
            
            /* EFEITO DE GÁS: O Blur deixa o gradiente difuso parecendo fumaça */
            filter: blur(1.5px);
            
            /* Animação lenta arrastada */
            animation: shine 6s linear infinite;
        }
    `;
    document.head.appendChild(style);

    const targetIcons = /(\uD83D\uDC51|\u269C\uFE0F?|\uD83E\uDD21|\uD83D\uDEE1\uFE0F?|\uD83D\uDD30)/g;
    const jesterEmoji = '\uD83E\uDD21'; // 🤡

    function styleTextNodes(node) {
        if (node.nodeType === 3 && targetIcons.test(node.nodeValue)) {
            const span = document.createElement('span');
            span.innerHTML = node.nodeValue.replace(targetIcons, (match) => {
                
                // Se for o Palhaço (Jester)
                if (match.indexOf(jesterEmoji) !== -1 || match === '🤡') {
                    // Cria o span com o data-text para gerar a fumaça
                    return `<span class="jester-icon" data-text="${match}">${match}</span>`;
                }
                
                // Se for Nobre (Shiny normal)
                return `<span class="shiny-icon">${match}</span>`;
            });
            node.parentNode.replaceChild(span, node);
        } else if (node.nodeType === 1 && 
                   node.tagName !== 'SCRIPT' && 
                   node.tagName !== 'STYLE' && 
                   !node.classList.contains('shiny-icon') &&
                   !node.classList.contains('jester-icon')) {
            Array.from(node.childNodes).forEach(styleTextNodes);
        }
    }

    const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
            mutation.addedNodes.forEach((node) => {
                styleTextNodes(node);
            });
        });
    });

    observer.observe(document.body, { childList: true, subtree: true });
    styleTextNodes(document.body);

})();
</script>
</body>
</html>