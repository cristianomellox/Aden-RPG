<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" 
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <meta name="robots" content="noindex, nofollow">
    <meta name="googlebot" content="noindex, nofollow">
    <title>Guilda - Aden RPG</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="maintenance.js"></script>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="mines.css" />
    <link rel="stylesheet" href="guild.css" />

</head>
<body>

    <div id="playerTopBar">
        <a href="index.html?refresh=true" class="top-bar-link" title="Voltar">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-left"><path d="m15 18-6-6 6-6"/></svg>
        </a>
       <div> <span id="pageTitle">Guilda</span></div>
        <img src="https://aden-rpg.pages.dev/assets/refresh.webp" alt="Recarregar" style="width:30px; height:30px;">
    </div>

    <div id="mainContainer">
        <div id="tabMenu">
            <span class="tab-btn active" data-tab="guilda">Guilda</span>
            <span class="tab-btn" data-tab="taverna">Taverna</span>
            <span class="tab-btn" data-tab="ranking">Ranking</span>
            <span class="tab-btn" data-tab="raid">Raid</span>
            <span class="tab-btn" data-tab="batalhas">Batalha</span>
        </div>

        <div id="tabContent">
            <div id="guilda" class="tab-pane active">
                <div id="guildInfoContainer" style="display:none;">
                   
              <div class="icon-container"><img id="editGuildBtn" src="https://aden-rpg.pages.dev/assets/config.webp" style="width:34px;height:34px;border-radius:4px; display: none;"></img></div>     
                    <div id="guildInfoHeader" style="display:flex; justify-content:center; align-items:center;">
                  
                        
                    </div>
                   <div id="guildName"></div>
<img alt="poder" id="cpIcon" style="width: 20px; height: 32px; margin-top: -4px;" src="https://aden-rpg.pages.dev/assets/CPicon.webp"/> <span id="guildPower" style="font-weight:bold; font-size:1.8em; margin-top:4px;"></span>

                    <div id="guildDescription" style="margin:6px 0;color:white; font-size: 0.8em;"></div>
                    
                    <div id="guildLevel">
                        <span style="color: yellow; font-weight: bold; font-size: 0.9em;">Nv. <span id="guildLevelValue"></span></span>
              <div class="xp-bar-container">
    <div class="xp-bar-fill"></div>
    <div id="guildXpFill"></div>
</div>

                    </div>
                    <div class="member-list-container">
                        <h4>Membros (<span id="guildMemberCountHeader">0</span>)</h4>
                        <ul id="guildMemberList"></ul>
                    </div>
                    <br><br><br>
                    <div style="border-bottom: 5px solid grey; border-radius: 8px;"></div>
                    <div id="risco">
  <h3>Área de Risco</h3>
  <div>
    <div id="deleteguild">
     
      <span>Deletar <br>Guilda</span>
    </div>
    <div id="leaveguild">
     
      <span>Sair <br>da Guilda</span>
    </div>
  </div>
</div>
                   
                </div>
                <div id="noGuildContainer" style="display:none;">
                  <div id="criar">
                    <p>Você não faz parte de uma guilda.</p>
                    <button class="action-btn" id="searchGuildBtn" style="color: white;"><span style="font-size: 1em;">Buscar <br>Guilda</span></button>
                    <button class="action-btn" id="createGuildBtn"style="color: white;"><span style="font-size: 1em;">Criar <br>Guilda</span></button>
                </div>
            </div>
</div>
            <div id="taverna" class="tab-pane">
               <div id="tavernContainer" class="tavern-container">
                  <h3 id="tavernTitle" style="margin-top: 110px; display:none;">Taverna da Guilda</h3>
                  <div class="tavern-header-inline" style="margin-top: 80px;display: flex;justify-content: center; align-items: center;">
  <h3 id="tavernTitle2">Taverna da Guilda</h3>
  <img id="tavtuto" src="https://aden-rpg.pages.dev/assets/tutorialbtn.webp" style="width:30px; height:30px; margin-top: -15px; right: 3px;">
  </div>
  <div id="tavernControls" style="margin-bottom:8px;"></div>

  <!-- Área ativa da Taverna (escondida até entrar) -->
  <div id="tavernActiveArea" style="display:none;">

    <div id="tavernChat" class="tavern-chat"></div>
    <div id="tavernChatInput">
      <input type="text" id="tavernMessageInput" placeholder="Digite uma mensagem..." maxlength="200" />
      <button id="tavernSendBtn" style="margin-top: -6px;" disabled>Enviar</button>
    </div>
  </div>
</div>
</div>
            


    

            <div id="ranking" class="tab-pane">
              <center>  <h3>Ranking das Guildas</h3>
              <h4 style="margin-top: -29px; color: orange;">Poder de Combate</h4>
              <p style="margin-top: -30px; font-size: 0.7em;">(atualiza diariamente às 21h)</p>
              </center>
                <ul id="guildRankingList"></ul>
            </div>

            <div id="raid" class="tab-pane" style="background: none;">
              <center><h3>Raid de Guilda</h3></center>
              <div id="raid_1">
               
                <div id="tdd">
                  <h3 class="tdd_h3">Torre da Desolação</h3>
                  <span class="tdd_desc">Segunda, Quarta e<br> Sexta-feira até 21h.<br>Líder e Co-Líderes<br>podem iniciar a Raid.</span>
                  <div id="tddbuttons">
                   <img id="raidtuto" src="https://aden-rpg.pages.dev/assets/tutorialbtn.webp" style="width:45px; height:45px;">
                    <img id="tddstory" src="https://aden-rpg.pages.dev/assets/tddstart.webp" style="width:47px; height:47px; margin-top: -2px;">
                     
                   </div>
                <img id="tddimg" src="https://aden-rpg.pages.dev/assets/tddbanner.webp" style="width: 90vw; height: 180px; background: none;">
      </div>      
<div id="raidModal" class="modal" style="display:none;">
  <div class="modal-content">
    <span class="close-btn">&times;</span>
    <h3>Torre da Desolação</h3>
    <p>Duração: 1 hora.</p>
    <p>Ganhe xp, Cristais, Pedras de Refundição, entre outras recompensas, junto com sua guilda.</p>
    <button id="startRaidBtn" class="action-btn">Iniciar Raid</button>
    <button id="cancelRaidBtn" class="action-btn">Cancelar</button>
  </div>
</div>

<div id="raidCombatModal" class="modal" style="display:none;">
  <div class="modal-content">
   <div id="raidCountdownContainer" style="display:none; text-align:center; padding: 40px 10px; color: white;">
        <h1 id="raidCountdownMessage" style="font-size: 1.4em; color: yellow; line-height: 1.5;"></h1>
        <div id="raidCountdownTimer" style="font-size: 3em; font-weight: bold; margin-top: 20px;"></div>
    </div>
   <div id="raidHeader" style="position:relative; display:flex; justify-content:center; align-items:center; padding:8px 0;">
  <div id="raidFloorInfo" style="position:absolute; left:-2px; margin-top: -24px; text-align:center;text-shadow:
        1px 1px 2px black,
        -1px -1px 2px black,
        1px -1px 2px black,
        -1px 1px 2px black, 
        0 0 2px black,
        0 0 4px black;"></div>
  <div id="raidTimerInfo" style="font-weight:bold; font-size:1.1em;"></div>
</div>
<div id="raidBackBtn" style="position:absolute; right:6px; margin-top: -16px; text-align:center;text-shadow:
        1px 1px 2px black,
        -1px -1px 2px black,
        1px -1px 2px black,
        -1px 1px 2px black, 
        0 0 2px black,
        0 0 4px black; font-weight: bold; display: flex; flex-direction: column; align-items: center; justify-content: center;"> <img src="https://aden-rpg.pages.dev/assets/sair.webp" style="width:22px; height: 28px;">
        <small style="font-size: 0.6em;">voltar</small>
        </div>

    <div id="raidMonsterArea">
      <div style="position: relative; width:100%; height: 380px; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center">
      <img id="raidMonsterImage" src="https://aden-rpg.pages.dev/assets/tddandar01.webp" style="width:220px; height: 320px;">
      </div>
      <div id="raidMonsterHpBar">
        <div id="raidMonsterHpFill"></div>
        <span id="raidMonsterHpText"></span>
      </div>
    </div>
   <center> <img id="raidAttackBtn" src="https://aden-rpg.pages.dev/assets/attackbtn.webp" style="width:70px;height:70px;cursor:pointer; margin-top: 9px;"></center>
    <p style="font-size: 0.8em; font-weight: bold; margin-top: -18px">
      Ataques: <span id="raidPlayerAttacks">0</span>
      <button id="raidBuyAttackBtn" class="btn btn-gold" style="vertical-align: -5px">+</button><br>
      <span id="raidAttackCooldown"></span>
    </p>
    <div id="raidDamageRankingContainer">
      <h4>Ranking de Dano</h4>
      <ul id="raidDamageRankingList"></ul>
    </div>
   
  </div>
</div>


<div id="lastRaidResultModal" class="modal" style="display:none;">
    <div class="modal-content">
        <h3>Resultado da Última Raid</h3>
        <p>Na sua última incursão na Torre da Desolação, sua guilda alcançou:</p>
        <h2 id="lastRaidFloorResult" style="color: yellow; font-size: 2em; margin: 10px 0;">Andar 0</h2>
        <button id="startNewRaidFromLastResultBtn" class="action-btn">Iniciar Nova Raid</button>
        <button id="closeLastResultBtn" class="action-btn">Fechar</button>
    </div>
</div>

<div id="raidRewardModal" class="modal" style="display:none; z-index: 12500">
  <div class="modal-content">
    <h3>Recompensa de Andar</h3>
    <p>Você ganhou:</p>
    <p><strong id="rewardXpText" style="color:lime;">0 XP</strong></p>
    <p><strong id="rewardCrystalsText" style="color:cyan;">0 Cristais</strong></p>
    <button id="rewardOkBtn" class="action-btn">Ok</button>
  </div>
</div>


                </div>
            </div>

            <div id="batalhas" class="tab-pane">
                 <center><h3>Batalha de Guilda</h3></center>
              <div id="gvg_1">
               
                <div id="gvgt">
                  <h3 class="gvgt_h3">Batalha por Territórios</h3>
                  <span class="gvgt_desc" style="background-color: rgba(0, 0, 0, 0.5);" onclick="window.location.href='guild_battle.html'"><strong>Registro:</strong> Sábado 21h00.<br><strong>Batalha:</strong> Domingo 20h30.</span>
                  <div id="gvgtbuttons">
                   <img id="gvgttuto" src="https://aden-rpg.pages.dev/assets/tutorialbtn.webp" style="width:45px; height:45px;">
                   </div>
                <img id="gvgtimg" src="https://aden-rpg.pages.dev/assets/gvg_cidades.webp" style="width: 90vw; height: 180px; background: none;" onclick="window.location.href='guild_battle.html'">
      </div>  </div>    
            </div>
        </div>
    </div>

    <div id="createGuildModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h3>Criar Nova Guilda</h3>
            <p>Custo: <strong class="crystals-cost">2000</strong> Cristais</p>
            <p>Nível Mínimo: <strong class="level-min">7</strong></p>
            <input type="text" id="newGuildNameInput" placeholder="Nome da Guilda" maxlength="12">
            <button id="confirmCreateGuildBtn" class="action-btn">Criar</button>
            <p id="createGuildMessage" class="message"></p>
        </div>
    </div>

    <div id="editGuildModal" class="modal" style="display:none;">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <span style="position: fixed; margin-top: 3.7rem; right: 3rem; font-weight: bold; color: gold; font-size: 1.2em;">>>></span>
            <h3>Editar Guilda</h3>

           <div id="editTabMenu" class="tab-scroll">
    <span class="edit-tab-btn" data-tab="tab-edit">Editar</span>
    <span class="edit-tab-btn" data-tab="tab-requests">Solicitações</span>
    <span class="edit-tab-btn" data-tab="tab-manage">Gerenciar</span>
    <span class="edit-tab-btn" data-tab="tab-notice">Quadro de Aviso</span>
    <span class="edit-tab-btn" data-tab="tab-chest">Baú</span>
</div>


            <div id="editTabContent">
                <div id="tab-edit" class="edit-tab-pane" style="display:none;">
                    <label>Nome da Guilda (1x a cada 30 dias):</label>
                    <input type="text" id="editGuildName" maxlength="25">
                    <p id="editNameInfo" class="message"></p>

                    <label>Descrição:</label>
                    <textarea id="editGuildDescription" style="height: 120px; width: 90%;" maxlength="100"></textarea>

                    <label>Bandeira (URL):</label>
                    <input type="text" id="editGuildFlagUrl" placeholder="https://...">

                    <button id="saveGuildChangesBtn" class="action-btn">Salvar Alterações</button>
                </div>

                <div id="tab-requests" class="edit-tab-pane" style="display:none;">
                    <h4>Solicitações Pendentes</h4>
                    <ul id="guildRequestsList"></ul>
                </div>

                <div id="tab-manage" class="edit-tab-pane" style="display:none;">
                    <h4>Gerenciar Membros</h4>
                    <ul id="manageMembersList"></ul>
                </div>

                <div id="tab-notice" class="edit-tab-pane" style="display:none;">
                    <h4>Aviso Atual</h4>
                    <div id="guildNotice" style="padding:8px;border:1px solid #ddd;border-radius:6px;background:#444;"></div>
                    <div id="noticeInfo" style="font-size:0.9em;color:white;margin-top:6px;"></div>
                    <div id="noticeEditor" style="margin-top:8px;display:none;">
                        <textarea id="editGuildNotice" placeholder="Escreva um aviso breve..." maxlength="150" style="height: 120px; width: 85%;"></textarea>
                        <button id="saveGuildNoticeBtn" class="action-btn">Atualizar Aviso</button>
                    </div>
                    <hr style="margin:10px 0;">
                    <h4>Registro de Atividades</h4>
                    <ul id="guildLogsList"></ul>
                </div>

                <div id="tab-chest" class="edit-tab-pane" style="display:none;">
                    <h4>Baú</h4>
                    <p>Em breve.</p>
                </div>
            </div>
        </div>
    </div>

    <div id="searchGuildModal" class="modal" style="display:none;">
      <div class="modal-content">
        <span class="close-btn">&times;</span>
        <h3>Buscar Guilda</h3>
        <input type="text" id="searchGuildInput" placeholder="Nome da guilda...">
        <button id="searchGuildConfirmBtn" class="action-btn">Buscar</button>
        <ul id="searchGuildResults"></ul>
      </div>
    </div>
    <div id="viewGuildModal" class="modal" style="display:none;">
    <div class="modal-content">
        <span class="close-btn" id="viewGuildCloseBtn">&times;</span>
        <div id="guildViewContainer">
            <div id="guildViewHeader" style="display:flex; justify-content:center; align-items:center;"></div>
            <div id="guildViewName" style="text-align: center; font-size: 1.4em;"></div>
            <div style="text-align: center;">
                <img alt="poder" id="cpIcon" style="width: 28px; height: 37px; vertical-align: -4px;" src="https://aden-rpg.pages.dev/assets/CPicon.webp"/>
                <span id="guildViewPower" style="color:orange; font-weight:bold; font-size:1.7em; margin-top:4px;"></span>
            </div>
            <div id="guildViewDescription" style="margin:6px 0;color:white; font-size: 0.8em; text-align: center;"></div>
            <div style="text-align: center;">
                <span style="color: yellow; font-weight: bold; font-size: 1.3em;">Nv. <span id="guildViewLevelValue"></span></span>
            </div>
            <div class="member-list-container">
                <h4>Membros (<span id="guildViewMemberCountHeader">0</span>)</h4>
                <ul id="guildViewMemberList"></ul>
            </div>
            <div id="guildViewActions" style="text-align: center; margin-top: 20px;">
              
            </div>
        </div>
    </div>
</div>


<div id="playerModal" class="modal" style="display:none; width: 92%;">
  <div class="modal-content">
    <span id="closePlayerModal" class="close-btn">&times;</span>

    <h3 id="playerName">Jogador</h3>
    <div id="playerLevel">Nv. 0</div>

    <div id="equipmentAndAvatarContainer">
      <div class="equipment-column">
        <div id="weapon-slot" class="equipment-slot" data-slot="weapon"></div>
        <div id="ring-slot" class="equipment-slot" data-slot="ring"></div>
        <div id="helm-slot" class="equipment-slot" data-slot="helm"></div>
        <div id="special1-slot" class="equipment-slot" data-slot="special1"></div>
      </div>

      <div id="playerAvatarEquipContainer">
        <div class="guild-header">
          <div style="display: flex;
  flex-direction: column; justify-content: center; text-align: center; align-items: center;">
          <img id="playerGuildFlag" src="https://aden-rpg.pages.dev/assets/guildaflag.webp" alt="Bandeira" onerror="this.style.display='none'">
          <div id="playerGuildName">Nome da Guilda</div>
        </div>
</div>
        <img id="playerAvatarEquip" src="https://via.placeholder.com/100" alt="Avatar do Jogador">
        <div style="display: flex; flex-wrap: nowrap; width: 100%; gap: 12px; justify-content: center; text-align: center; align-items: center;">
        <img alt="poder" id="cpIcon" style="width: 18px; height: 30px; vertical-align: 4px; position: relative; margin-top: 3px;" src="https://aden-rpg.pages.dev/assets/CPicon.webp"/><div id="playerCombatPower">0 </div>
      </div>
</div>
      <div class="equipment-column">
        <div id="amulet-slot" class="equipment-slot" data-slot="amulet"></div>
        <div id="wing-slot" class="equipment-slot" data-slot="wing"></div>
        <div id="armor-slot" class="equipment-slot" data-slot="armor"></div>
        <div id="special2-slot" class="equipment-slot" data-slot="special2"></div>
      </div>
    </div>

    <div id="attributesSection">
      <div class="attribute-row">
        <div class="attribute-item">
          <span class="attribute-label">ATK</span>
          <span id="playerAttack" class="attribute-value">0 - 0</span>
        </div>
        <div class="attribute-item">
          <span class="attribute-label">TAXA CRIT</span>
          <span id="playerCritChance" class="attribute-value">0%</span>
        </div>
        <div class="attribute-item">
          <span class="attribute-label">DANO CRIT</span>
          <span id="playerCritDamage" class="attribute-value">0%</span>
        </div>
      </div>

      <div class="attribute-row">
        <div class="attribute-item">
          <span class="attribute-label">HP</span>
          <span id="playerHealth" class="attribute-value">0</span>
        </div>
        <div class="attribute-item">
          <span class="attribute-label">DEFESA</span>
          <span id="playerDefense" class="attribute-value">0</span>
        </div>
        <div class="attribute-item">
          <span class="attribute-label">EVASÃO</span>
          <span id="playerEvasion" class="attribute-value">0%</span>
        </div>
      </div>
    </div>
    <div style="display: flex; justify-content: center; align-items: center;">
      <button id="sendmp" style="display: none; text-align: center; display: flex; align-items: center; justify-content: center; gap: 10px; font-size: 1em; padding: 0 0;"><img src="https://aden-rpg.pages.dev/assets/iconsender.webp" style="width: 35px; height: 35px;"> Enviar Mensagem</button> 
    </div>
  </div>
</div>
<div id="buyModal" class="modal" style="display: none; z-index: 13501;">
  <div class="modal-content">
    <h3>Confirmar Compra</h3>
    <p id="buyPlayerGoldInfo"><img src="https://aden-rpg.pages.dev/assets/goldcoin.webp" style="width: 17px; height: 17px"></p>
    <p>Os ataques comprados só poderão ser usados na Raid atual.</p>

    <p>Quantidade de ataques:</p>
    <div style="display: flex; justify-content: center; align-items: center; gap: 35px;">
      <div style="background: #333; border-radius: 8px; border: white; width: 140px; display:flex; justify-content: center; align-items: center;">
        <button id="buyDecreaseQtyBtn" class="action-btn">-</button>
        <span id="buyAttackQty" style="font-size: 2em; color: yellow; margin: 0 12px;">1</span>
        <button id="buyIncreaseQtyBtn" class="action-btn">+</button>
      </div>
    </div>
    <p id="buyAttackCostInfo">Custo total: 0 Ouro</p>
    <div style="display: flex; justify-content: space-around; margin-top: 20px;">
      <button id="buyCancelBtn" class="action-btn confirmabuy-btn">Cancelar</button>
      <button id="buyConfirmBtn" class="action-btn confirmabuy-btn">Confirmar</button>
    </div>
  </div>
</div>


<div id="raidAlertModal" class="modal" style="display:none; z-index:15000; align-items: center; justify-content: center;">
  <div class="modal-content">
    <h3>Aviso</h3>
    <p id="raidAlertMessage"></p>
    <button id="raidAlertOkBtn" class="action-btn">OK</button>
  </div>
</div>

<div id="tutorialModaltav" class="modal-overlay2" style="display: none; height: 650px!important;">
        <div class="modal-content2">
           <center><h3 style="color: white;">Taverna da Guilda</h3></center>
<p>A taverna é o local onde os membros da guilda se reúnem para conversar e trocar informações.</p>
<p><strong>Dica:</strong> A Taverna não é necessariamente um chat ativo, pois tem um tempo mínimo para envio de mensagens e um limite de histórico antigo. Use-a para deixar recados importantes.</p>
<center><button id="closetavTutorialBtn" class="action-btn">Fechar</button></center>
</div></div>

<div id="tutorialModalRaid" class="modal-overlay2" style="display: none;">
        <div class="modal-content2">
           <center><h3>Guia Completo da Torre da Desolação (Raid)</h3></center>
<p>A Torre da Desolação (Raid) é um desafio cooperativo onde sua Guilda deve trabalhar em conjunto para derrotar monstros em andares progressivamente mais difíceis e conquistar recompensas.</p>
            <hr>
<center><h4>1. Início da Raid</h4></center>
<p>A Raid não é automática. Ela precisa ser iniciada por alguém na sua Guilda.</p>
<ul>
<li><strong>Quem Inicia:</strong> Apenas o <strong>Líder</strong> ou <strong>Co-Líder</strong> da Guilda pode começar a Raid.</li>
<li><strong>Quando Iniciar:</strong> A Raid só pode ser iniciada <strong>Segunda, Quarta e Sexta-feira</strong>.</li>
<li><strong>Frequência:</strong> Sua Guilda pode iniciar a Raid <strong>apenas uma vez por dia</strong>.</li>
<li><strong>Preparo:</strong> Ao ser iniciada, a <strong>Vida</strong> de <strong>todos os membros</strong> da Guilda é instantaneamente restaurada ao máximo.<br>
O tempo de preparação é de 10 minutos.</li></ul>
            <hr>
<center><h4>2. Ataques e Tentativas</h4></center>
<p>Sua capacidade de ataque é limitada e se recupera com o tempo.</p>
<ul>
<li><strong>Limite de Ataques:</strong> Você pode acumular um máximo de <strong>3 ataques</strong> disponíveis de uma vez.</li>
<li><strong>Recuperação:</strong> Você recupera <strong>1 ataque</strong> a cada <strong>60 segundos</strong> (1 minuto).</li>
<li><strong>Comprando Ataques Extras (Ouro):</strong> O preço aumenta progressivamente a cada 5 ataques comprados no dia. O custo reseta diariamente.</li>
</ul>
<hr>
<center><h4>3. Batalhas de Chefe e Morte</h4></center>
<p>A cada 5 andares, você enfrentará o Imperador Veinur que ataca.</p>
<p>O Imperador Veinur consegue te ver através de seus servos e irá interagir falando com você durante toda a Raid.</p>
<ul>
<li><strong>Andares de Chefe:</strong> O Imperador Veinur aparece nos andares múltiplos de 5 (Andar 5, Andar 10, etc.).</li>
<li><strong>Ataque do Chefe:</strong> O Imperador Veinur ataca <strong>todos</strong> os jogadores ativos na Raid a cada <strong>30 segundos</strong>. A <i style="color: lightblue;"><strong>habilidade passiva</strong></i> do chefe ignora a Evasão dos jogadores, ou seja, não importa o quanto de Evasão você tiver, o Imperador Veinur sempre te acertará.</li>
<li><strong>Morte em Raid e Reviver:</strong> Se sua <strong>Vida</strong> chegar a zero, você é derrotado. Após um período de espera, sua Vida é restaurada ao máximo, permitindo que você retorne.</li>
</ul>
<hr>
<center><h4>4. Recompensas e Progresso</h4></center>
<p>O trabalho em equipe é a chave para as recompensas e o avanço.</p>
<ul>
<li><strong>Recompensas:</strong> Você recebe <strong>Cristais</strong> e <strong>Experiência (XP)</strong> proporcionais ao seu dano total no monstro.<br>A guilda também ganha XP.<br>Há chance de receber outros <strong>Itens</strong> como recompensa.</li>
<li><strong>Avanço:</strong> Após derrotar o monstro, o ranking de dano é zerado e a Guilda avança para o próximo andar.</li>
<li><strong>Fim da Raid:</strong> A Torre da Desolação é concluída após o <strong>Andar 40</strong> ou após o tempo de <strong>1 hora</strong>.</li>
</ul>
<p>Acompanhe sua vida e use seus ataques com sabedoria para maximizar sua contribuição! </p>
<center><button id="closeRaidTutorialBtn" class="action-btn">Fechar</button></center>
        </div>
    </div>
    <div id="tddModalStory" class="modal-overlay2" style="display: none;">
    <div class="modal-content2">
        <div id="videoContainer">
            <iframe 
                id="tddStoryVideo"
                width="100%" 
                height="100%" 
                src="https://www.youtube.com/embed/c7NZ7wrpTSM?autoplay=0&controls=1&modestbranding=1&rel=0" 
                frameborder="0" 
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; picture-in-picture" 
                allowfullscreen>
            </iframe>
        </div>
        
        <center><button id="closetddstoryBtn" class="action-btn">Fechar</button></center>       
    </div>
</div>

<div id="tutorialModalgvgt" class="modal-overlay2" style="display: none;">
    <div class="modal-content2">
        <center><h3>Guia Completo da Batalha por Territórios</h3></center>
        <p>Seja bem-vindo, guerreiro! A Batalha por Territórios é um evento de guilda, onde o poder e a estratégia da sua aliança decidem o controle de cidades vitais.</p>
        <hr>

        <center><h4>1. Fase de Registro</h4></center>
        <p>A Batalha por Territórios ocorre semanalmente. Sua guilda deve se registrar para desafiar uma cidade:</p>
        <ul>
            <li><strong>Prazo Final:</strong> O registro abre no <strong>Sábado às 21:00</strong> e fecha no <strong>Domingo às 20:00</strong>.</li>
            <li><strong>Limite de Desafios:</strong> Apenas 4 guildas podem se registrar para disputar cada cidade.</li>
            <li><strong>Ação Necessária:</strong> Um líder ou co-líder da guilda deve escolher a cidade para o registro.</li>
        </ul>
        
        <center><h4>1.2 Combate</h4></center>
        <p>A batalha começa no <strong>Domingo às 20:30</strong> e tem duração de <strong>30 minutos</strong>.</p>
<hr>
        <center><h4>2. O Campo de Batalha</h4></center>
        <p>Cada cidade possui <strong>5 Objetivos</strong> que devem ser atacados e dominados para acumular <strong>Pontos de Honra</strong>:</p>
        <ul>
            <li><strong>O Nexus (1 Ponto):</strong> Objetivo central, com 600.000 HP.</li>
            <li><strong>Pontos de Controle (4 Pontos):</strong> Objetivos secundários, cada um com 300.000 HP.</li>
        </ul>
        <p>A guilda com mais Pontos de Honra no final da batalha vence e conquista a cidade.</p>
        <hr>

        <center><h4>3. Ações de Batalha e Combate</h4></center>
        <p>Sua participação é limitada por <strong>Ações de Batalha</strong>:</p>
        <ul>
            <li><strong>Limite Máximo:</strong> Você pode acumular um máximo de <strong>3 Ações</strong>.</li>
            <li><strong>Recuperação:</strong> Você recupera <strong>1 Ação</strong> a cada <strong>60 segundos</strong> (1 minuto).</li>
            <li><strong>Comprando Ações:</strong> Você pode comprar reforços com Ouro (Pacote 1: 3 Ações / Pacote 2: 5 Ações).</li>
        </ul>
        <p>Você pode usar suas ações de duas formas:</p>
        <ul>
            <li><strong>ATACAR (Custo: 1 Ação):</strong> Causa dano ao objetivo. O dano primeiro atinge a Guarnição dos inimigos e só depois o HP principal do Objetivo.</li>
            <li><strong>GUARNECER (Custo: 1 Ação):</strong> Junta-se à Guarnição de um Objetivo dominado pela sua guilda, aumentando o HP de defesa do ponto.</li>
        </ul>
        <hr>

        <center><h4>4. Captura e Pontuação</h4></center>
        <p>Ao zerar o HP principal de um Objetivo, a guilda que causou o maior dano total o captura e ganha Honra:</p>
        <ul>
            <li><strong>Captura do Nexus:</strong> <strong>+300 Pontos de Honra</strong> distribuídos entre as guildas que atacaram de acordo com seu dano.</li>
            <li><strong>Captura de Ponto de Controle:</strong> <strong>+100 Pontos de Honra</strong> distribuídos entre as guildas que atacaram de acordo com seu dano.</li>
            <li><strong>Perda:</strong> A guilda que perde o objetivo é penalizada na mesma quantidade de Honra.</li>
        </ul>
        <hr>

        <center><h4>5. Recompensas</h4></center>
        <p>As recompensas são distribuídas para as guildas que terminarem nas 3 primeiras posições e apenas para os jogadores que participaram ativamente (causaram dano):</p>
        <table style="width: 100%; border-collapse: collapse; text-align: left; color: white;">
            <thead>
                <tr>
                    <th style="padding: 5px; border-bottom: 1px solid #444;">Classificação</th>
                    <th style="padding: 5px; border-bottom: 1px solid #444;">Recompensas</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td style="padding: 5px;"><strong>1º Lugar</strong></td>
                    <td style="padding: 5px;">4 Cartões de Espiral Avançado, 50 Pedras de Refundição e 3000 Cristais.</td>
                </tr>
                <tr>
                    <td style="padding: 5px;"><strong>2º Lugar</strong></td>
                    <td style="padding: 5px;">6 Cartões de Espiral Comum, 20 Pedras de Refundição e 1000 Cristais.</td>
                </tr>
                <tr>
                    <td style="padding: 5px;"><strong>3º Lugar</strong></td>
                    <td style="padding: 5px;">4 Cartões de Espiral Comum, 10 Pedras de Refundição e 500 Cristais.</td>
                </tr>
            </tbody>
        </table>
        <p>O jogador top 1 de dano terá suas recompensas triplicadas (se for da guilda vencedora).<br>
        O jogador top 2 de dano terá suas recompensas duplicadas (se for da guilda vencedora).</p>

        <p>Participe, planeje seus ataques e guarnições para levar sua guilda à vitória!</p>
        <center><button id="closegvgtTutorialBtn" class="action-btn">Fechar</button></center>
    </div>
</div>


<script>
        document.addEventListener("DOMContentLoaded", () => {
            const tavtutoImg = document.getElementById("tavtuto");
            const tutorialModal = document.getElementById("tutorialModaltav");
            const closetavTutorialBtn = document.getElementById("closetavTutorialBtn");

            if (tavtutoImg) {
                tavtutoImg.addEventListener("click", () => {
                    tutorialModaltav.style.display = "flex";
                });
            }

            if (closetavTutorialBtn) {
                closetavTutorialBtn.addEventListener("click", () => {
                    tutorialModaltav.style.display = "none";
                });
            }

            if (tutorialModaltav) {
                window.addEventListener("click", (event) => {
                    if (event.target === tutorialModaltav) {
                        tutorialModaltav.style.display = "none";
                    }
                });
            }
        });
    </script>
    
     <script>
        document.addEventListener("DOMContentLoaded", () => {
            const raidtutoImg = document.getElementById("raidtuto");
            const tutorialModal = document.getElementById("tutorialModalRaid");
            const closeRaidTutorialBtn = document.getElementById("closeRaidTutorialBtn");

            if (raidtutoImg) {
                raidtutoImg.addEventListener("click", () => {
                    tutorialModalRaid.style.display = "flex";
                });
            }

            if (closeRaidTutorialBtn) {
                closeRaidTutorialBtn.addEventListener("click", () => {
                    tutorialModalRaid.style.display = "none";
                });
            }

            if (tutorialModalRaid) {
                window.addEventListener("click", (event) => {
                    if (event.target === tutorialModalRaid) {
                        tutorialModalRaid.style.display = "none";
                    }
                });
            }
        });
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const gvgttutoImg = document.getElementById("gvgttuto");
            const tutorialModalgvgt = document.getElementById("tutorialModalgvgt");
            const closegvgtTutorialBtn = document.getElementById("closegvgtTutorialBtn");

            if (gvgttutoImg) {
                gvgttutoImg.addEventListener("click", () => {
                    tutorialModalgvgt.style.display = "flex";
                });
            }

            if (closegvgtTutorialBtn) {
                closegvgtTutorialBtn.addEventListener("click", () => {
                    tutorialModalgvgt.style.display = "none";
                });
            }

            if (tutorialModalgvgt) {
                window.addEventListener("click", (event) => {
                    if (event.target === tutorialModalgvgt) {
                        tutorialModalgvgt.style.display = "none";
                    }
                });
            }
        });
    </script>

  <script>
        document.addEventListener("DOMContentLoaded", () => {
            const tddstory = document.getElementById("tddstory");
            const tddstorymodal = document.getElementById("tddModalStory");
            const closetddstoryBtn = document.getElementById("closetddstoryBtn");

            if (tddstory) {
                tddstory.addEventListener("click", () => {
                    tddstorymodal.style.display = "flex";
                });
            }

            if (closetddstoryBtn) {
                closetddstoryBtn.addEventListener("click", () => {
                    tddstorymodal.style.display = "none";
                });
            }

            if (tddstorymodal) {
                window.addEventListener("click", (event) => {
                    if (event.target === tddstorymodal) {
                        tddstorymodal.style.display = "none";
                    }
                });
            }
        });
    </script>
    






<div id="loading-overlay" style="background-image: url('https://aden-rpg.pages.dev/assets/guildhall.webp');
    background-repeat: no-repeat;
    background-position: center center;
    background-size: cover;">
  <div id="loading-container">
    <h2>Carregando...</h2>
    <div id="progress-bar-container">
      <div id="progress-bar"></div>
    </div>
    <span id="progress-text">0%</span>
  </div>
</div>

<div id="banModalOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.95); color: white; z-index: 10000; justify-content: center; align-items: center; text-align: center; flex-direction: column;">
    <div style="background: #2b2b2b; padding: 30px; border-radius: 15px; box-shadow: 0 0 25px rgba(255, 69, 0, 0.8); max-width: 90%; width: 400px; border: 3px solid #ff4500;">
        <img src="https://aden-rpg.pages.dev/assets/expulsar.webp" alt="Aviso" style="width: 80px; height: 80px; margin-bottom: 10px;">
        <h2 style="color: #ff4500; font-size: 1.8em; margin-bottom: 20px;">Você foi banido(a)!</h2>
        
        <p style="text-align: left; margin-bottom: 25px;">
            <strong>Motivo:</strong><br>
            <span id="banReasonContent" style="color: #ffd700; display: block; margin-top: 5px; padding: 10px; border: 1px dashed #444; white-space: pre-wrap;">[Carregando Motivo...]</span>
        </p>

        <button id="logoutBanBtn" style="background: linear-gradient(to top, #ff4500, #ff8c00); color: white; padding: 12px 25px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 1.1em; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3); transition: background 0.2s;">
            Fechar
        </button>
    </div>
</div>


<div id="maintenance-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.9); color: white; z-index: 99999; justify-content: center; align-items: center; text-align: center; flex-direction: column; font-family: Arial, sans-serif;">
    <img src="https://aden-rpg.pages.dev/assets/config.webp" alt="Manutenção" style="width: 120px; height: 120px; margin-bottom: 20px;">
    <h1 id="maintenance-title">Aviso de Manutenção</h1>
    <p id="maintenance-message" style="font-size: 1.1em; max-width: 80%;"></p>
    <p style="font-size: 0.9em; margin-top: 20px;">Obrigado pela sua paciência.</p>
</div>
<div id="countdown-banner" style="display: none; position: fixed; top: 0; left: 0; width: 100%; padding: 10px; background-color: rgba(0, 0, 0, 0.9); color: white; text-align: center; z-index: 9999; font-family: Arial, sans-serif; box-shadow: 0 4px 8px rgba(0,0,0,0.3); font-weight: bold;">
    <div style="font-size: 1.5em; font-weight: bold;">
        <span id="countdown-timer"></span>
    </div>
    <div style="font-size: 0.9em; margin-top: 5px;">
        O servidor entrará em manutenção dentro de instantes. Por favor, não inicie alguma operação no jogo para não ter risco de perda de dados. Obrigado pela paciência!
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  // cria um elemento para medir o tamanho real de 1rem
  const testEl = document.createElement("div");
  testEl.style.cssText = "position:absolute;visibility:hidden;font-size:1rem;line-height:1;";
  testEl.textContent = "M";
  document.body.appendChild(testEl);

  const actualRem = testEl.getBoundingClientRect().height;
  document.body.removeChild(testEl);

  console.log("[scale-lock] 1rem real:", actualRem, "px");

  // queremos sempre 16px como base (modo padrão)
  const targetRem = 16;
  const correction = targetRem / actualRem;

  const style = document.createElement("style");
  style.textContent = `
    html { font-size: ${16 * correction}px !important; }
    body { font-size: 1.5rem !important; }
  `;
  document.head.appendChild(style);

  console.log("[scale-lock] Correção aplicada, fator:", correction.toFixed(2));
});
</script>

<script>
// --- INÍCIO DO SCRIPT DE VERIFICAÇÃO DE BANIMENTO ---
document.addEventListener("DOMContentLoaded", async () => {
    // Configurações do Supabase (A mesma utilizada em seus outros arquivos)
    const SUPABASE_URL = 'https://lqzlblvmkuwedcofmgfb.supabase.co';
    const SUPABASE_ANON_KEY = 'sb_publishable_le96thktqRYsYPeK4laasQ_xDmMAgPx';
    
    // Verifica se o SDK foi carregado (o que é esperado)
    if (!window.supabase) {
        console.error("Supabase SDK não está carregado. Não é possível verificar banimento.");
        return;
    }
    
    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
    let userId = null;

    try {
        const { data: { user } } = await supabase.auth.getUser();
        if (user) userId = user.id;
    } catch (e) {
        // Ignora erros de autenticação (pode estar deslogado), o script principal da página cuidará disso.
        return;
    }

    if (!userId) {
        // Usuário não logado.
        return; 
    }

    // --- VERIFICAÇÃO DE BANIMENTO NA TABELA 'players' ---
    try {
        const { data, error } = await supabase
            .from('players') // USANDO A TABELA CORRETA 'players'
            .select('is_banned, ban_reason')
            .eq('id', userId)
            .single();

        if (error) {
            console.error("Erro ao verificar status de banimento:", error);
            // Se houver erro, o script não trava o jogo, apenas registra o erro.
            return;
        }

        if (data && data.is_banned === true) {
            console.warn(`Usuário ${userId} está banido. Exibindo modal.`);
            
            // 1. Encontrar elementos do Modal
            const banModal = document.getElementById('banModalOverlay');
            const banReasonContent = document.getElementById('banReasonContent');
            const logoutBanBtn = document.getElementById('logoutBanBtn');
            
            if (banModal && banReasonContent && logoutBanBtn) {
                // 2. Preencher o motivo
                banReasonContent.innerText = data.ban_reason || "Motivo não especificado. Entre em contato com o suporte.";
                
                // 3. Exibir o Modal (usando flex para centralizar)
                banModal.style.display = 'flex';
                
                // 4. Adicionar o evento de Logout ao botão "Fechar"
                logoutBanBtn.onclick = async () => {
                    await supabase.auth.signOut();
                    // Redireciona para o index para garantir que a sessão foi limpa
                    window.location.href = "index.html?logout=true"; 
                };

                // Bloquear a rolagem da página por trás do modal
                document.body.style.overflow = 'hidden';

                // ** IMPORTANTE: Interromper a execução de todos os outros scripts da página **
                // Não há uma maneira limpa de fazer isso com scripts síncronos, 
                // mas garantimos que as principais ações não ocorram ao retornarmos aqui.
                // Outros scripts que leem o DOM devem ser estruturados para depender do login/status.
            } else {
                // Fallback de segurança se o HTML do modal não foi incluído
                console.error("Modal de banimento não encontrado. Redirecionando como fallback.");
                window.location.href = "index.html?logout=true"; 
            }
        }
    } catch (e) {
        console.error("Erro geral no check de banimento:", e);
    }
});
// --- FIM DO SCRIPT DE VERIFICAÇÃO DE BANIMENTO ---
</script>

 <script src="guild_raid.js"></script>
<script src="loading.js"></script>
   <script src="number_format.js"></script>
    <script src="guild.js"></script>
    <script src="playerModal.js"></script>
<script src="guild_pv.js"></script>
</body>
<script defer src="guild_tavern.js"></script>


</body>
</html>